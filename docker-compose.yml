services:
  gem:
    build: .
    entrypoint: bundle
    command: exec rackup -o '0.0.0.0' -p '50052'
    volumes:
      - .:/usr/src/gem:delegated

  bundle:
    build: .
    entrypoint: bundle
    command: check
    volumes:
      - .:/usr/src/gem:delegated
      - bundle:/usr/local/bundle:delegated

  rspec:
    build: .
    entrypoint: bundle exec rspec
    command: --version
    volumes:
      - .:/usr/src/gem:delegated
      - bundle:/usr/local/bundle:delegated

volumes:
  bundle: {}
